<html lang="en">
<meta charset=utf-8>
<title>K-LoRA</title>
<link href=stylesheet_1.css rel=stylesheet>
<meta name=referrer content=no-referrer>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- <link rel=icon type=image/x-icon href=images/0.ico>
<link rel=canonical href=https://ziplora.github.io /> -->
<meta http-equiv=content-security-policy
    content="default-src 'none'; connect-src 'self' data: blob:; font-src 'self' data: blob:; img-src 'self' data: blob:; style-src 'self' 'unsafe-inline' data: blob:; frame-src 'self' data: blob:; media-src 'self' data: blob:; script-src 'self' 'unsafe-inline' data: blob:; object-src 'self' data: blob:;">
<style>
    img[src="data:,"],
    source[src="data:,"] {
        display: none !important
    }
</style>

</head>

<body>
    <div class="content">
        <h1><strong>K-LoRA: Unlocking Training-Free Fusion of Any Subject and Style LoRAs</strong></h1>
        <p id="authors">
            <a href="" title="Ziheng Ouyang's homepage">Ziheng Ouyang<sup></sup></a>
            <a href="https://paper99.github.io/" title="Zhen Li's homepage">Zhen Li<sup></sup></a>
            <a href="https://houqb.github.io/" title="Qibin Hou's homepage">Qibin Hou<sup></sup></a>
            <br><br>
            <span style="font-size:24px; padding-right:20px"><sup></sup>VCIP, School of Computer Science, Nankai
                University</span>
        </p>
        <br>
        <div class="top-images">
            <img class="summary-img" src="images/teaser.svg" style="width:100%" alt="">
        </div>

        <div style="text-align: center;">
            <span style="font-size: 20px; padding-right: 20px; font-style: italic;">
                <sup></sup>Our method supports advanced generative models such as <strong>Flux</strong> and Stable
                Diffusion, etc.
            </span>
        </div>

        <br>
        <br>
        <p style="text-align:center; font-size: 18px;">
            <a href="" target="_blank" rel="noopener" title="View Paper" style="display: inline-block; margin-right: 10px;">[Paper]</a>
            <a href="https://github.com/HVision-NKU/K-LoRA" target="_blank" rel="noopener" title="View code" style="display: inline-block;">[code]</a>
        </p>
        
    </div>


    <div class="content">
        <h2 style="text-align:center">Visual results</h2>
        <p><strong>K-LoRA</strong> generally achieves a seamless integration of objects and styles, effectively
            preserving fidelity and preventing distortion.</p>
        <br>

        <!-- Slider 1 -->
        <div class="slider-container" data-slider-id="1">
            <div class="slider-images">
                <div class="slide">
                    <p class="image-caption">Results on Flux</p>
                    <img class="summary-img" src="images/520.svg" style="width:100%" alt="">
                </div>
                <div class="slide">
                    <p class="image-caption">Results on Flux</p>
                    <img class="summary-img" src="images/2.svg" style="width:100%" alt="">
                </div>
                <div class="slide">
                    <p class="image-caption">Results on Stable Diffusion</p>
                    <img class="summary-img" src="images/pictureMap_page-0001.jpg" style="width:100%" alt="">
                </div>
                <div class="slide">
                    <p class="image-caption">Results on Stable Diffusion</p>
                    <img class="summary-img" src="images/pictureMap(4)_page-0001.jpg" style="width:100%" alt="">
                </div>
            </div>
            <div class="slider-controls">
                <button class="prev" onclick="moveSlide(-1, 1)">&#10094;</button>
                <button class="next" onclick="moveSlide(1, 1)">&#10095;</button>
            </div>
            <div class="dots">
                <span class="dot" onclick="currentSlide(1, 1)"></span>
                <span class="dot" onclick="currentSlide(2, 1)"></span>
                <span class="dot" onclick="currentSlide(3, 1)"></span>
                <span class="dot" onclick="currentSlide(4, 1)"></span>
            </div>
        </div>


    </div>

    <div class=content>
        <h2 style=text-align:center>Abstract</h2>
        <p>Recent studies have explored combining different LoRAs to jointly generate learned style and content.
            However, existing methods either fail to effectively preserve both the original subject and style
            simultaneously or require additional training. In this paper, we argue that the intrinsic properties of LoRA
            can effectively guide diffusion models in merging learned subject and style. Building on this insight, we
            propose <strong>K-LoRA</strong>, a simple yet effective training-free LoRA fusion approach. In each
            attention layer, <strong>K-LoRA</strong> compares the Top-K elements in each LoRA to be fused, determining
            which LoRA to select for optimal fusion. This selection mechanism ensures that the most representative
            features of both subject and style are retained during the fusion process, effectively balancing their
            contributions. Experimental results demonstrate that the proposed method effectively integrates the subject
            and style information learned by the original LoRAs, outperforming state-of-the-art training-based
            approaches in both qualitative and quantitative results.</p>

    </div>
    <div class=content>
        <h2 style=text-align:center>Method</h2>
        <p>
            We utilizes the Top-K function to select the important LoRA weights in each forward layer based on the sum
            of matrix elements.
        </p>
        <br>

        <img class=summary-img src="images\net_page-0001.jpg" style=width:100% alt="">
    </div>

    <div class=content>
        <h2 style=text-align:center>Comparison results</h2>
        <p>Compared to other methods, <strong>K-LoRA</strong> We provide comparisons with Direct Merge, Joint Training,
            B-LoRA and ZipLoRA.</p>
        <br>
        <img class=summary-img src="images\1.svg" style=width:100% alt="">
    </div>



    <!-- <div class=content>
        <h2 style=text-align:center>Conclusions</h2>
        <p>We derive key conclusions. (i) Only a restricted number of diffusion prediction steps are sufficient to
            retain the original effect. (ii) When applying LoRA, the initial diffusion steps are responsible for
            reconstructing the object and capturing larger texture details, while the subsequent steps focus on
            enhancing and refining the finer details of the object and the texture in style.</p>
        <br>
        <br>

        <img class=summary-img src="images/1.svg" style=width:100% alt="">
    </div> -->




    <div class=content>
        <h2 style=text-align:center>Prompt control</h2>
        <p>
            We conducted experiments to evaluate whether our method can modify the object's actions, the surrounding
            environment, or introduce new contents through prompt adjustments. We also used B-LoRA to obtain comparison
            results. (In B-LoRA, for cases where testing with multiple seeds fails to generate the original object after
            adding additional prompts, we append the class of the original content after &lt;c&gt;.)
        </p>

        <!-- Slider 2 -->
        <div class="slider-container" data-slider-id="2">
            <div class="slider-images">
                <div class="slide">
                    <img class="summary-img" src="images/61.svg" style="width:100%" alt="">
                </div>
                <div class="slide">
                    <img class="summary-img" src="images/62.svg" style="width:100%" alt="">
                </div>
                <div class="slide">
                    <img class="summary-img" src="images/63.svg" style="width:100%" alt="">
                </div>
                <div class="slide">
                    <img class="summary-img" src="images/64.svg" style="width:100%" alt="">
                </div>
            </div>

            <div class="slider-controls">
                <button class="prev" onclick="moveSlide(-1, 2)">&#10094;</button>
                <button class="next" onclick="moveSlide(1, 2)">&#10095;</button>
            </div>
            <div class="dots">
                <span class="dot" onclick="currentSlide(1, 2)"></span>
                <span class="dot" onclick="currentSlide(2, 2)"></span>
                <span class="dot" onclick="currentSlide(3, 2)"></span>
                <span class="dot" onclick="currentSlide(4, 2)"></span>
            </div>
        </div>
    </div>


    <!-- <img class="summary-img" src="images/prompt3_page-0001.jpg" alt="" style="width:100%">
        <br>
        <br>
        <br>
        <img class="summary-img" src="images/prompt4_page-0001.jpg" alt="" style="width:100%">
        <br> -->

    <!-- <div class=content>
        <h2>BibTex</h2>
        <code> @article{shah2023ZipLoRA,<br>
 &nbsp;&nbsp;title={ZipLoRA: Any Subject in Any Style by Effectively Merging LoRAs},<br>
 &nbsp;&nbsp;author={Shah, Viraj and Ruiz, Nataniel and Cole, Forrester and Lu, Erika and Lazebnik, Svetlana and Li, Yuanzhen and Jampani, Varun},<br>
 &nbsp;&nbsp;booktitle={arXiv preprint arxiv:2311.13600},<br>
 &nbsp;&nbsp;year={2023}<br>
 } </code>
    </div> -->

    <!-- <div class=content id=acknowledgements>
        <p><em>Acknowledgements</em>:
            We thank Prafull Sharma, Meera Hahn, Jason Baldridge and Dilip Krishnan for helpful discussions and
            suggestions. We also thank Kihyuk Sohn for helping with the generation of StyleDrop results.
        </p> -->
    <script>
        // Initialize slideIndex for multiple sliders
        let slideIndex = [1, 1]; // We store the index for each slider

        // Function to show a specific slide based on the sliderId
        function showSlide(n, sliderId) {
            let slides = document.querySelectorAll(`[data-slider-id="${sliderId}"] .slider-images .slide`);
            let dots = document.querySelectorAll(`[data-slider-id="${sliderId}"] .dot`);

            if (n > slides.length) slideIndex[sliderId - 1] = 1;
            if (n < 1) slideIndex[sliderId - 1] = slides.length;

            for (let i = 0; i < slides.length; i++) {
                slides[i].style.display = "none";
            }

            for (let i = 0; i < dots.length; i++) {
                dots[i].classList.remove("active");
            }

            slides[slideIndex[sliderId - 1] - 1].style.display = "block";
            dots[slideIndex[sliderId - 1] - 1].classList.add("active");
        }

        // Move slide up/down by 1 step
        function moveSlide(n, sliderId) {
            slideIndex[sliderId - 1] += n;
            showSlide(slideIndex[sliderId - 1], sliderId);
        }

        // Jump to a specific slide
        function currentSlide(n, sliderId) {
            slideIndex[sliderId - 1] = n;
            showSlide(slideIndex[sliderId - 1], sliderId);
        }

        // Initialize the first slide for each slider
        document.querySelectorAll('.slider-container').forEach((container, index) => {
            showSlide(slideIndex[index], index + 1);
        });
    </script>

    <style>
        .slider-container {
            position: relative;
            max-width: 100%;
        }

        .slider-images .slide {
            display: none;
            text-align: center;
        }

        .image-caption {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
            font-style: italic;
            text-align: center;
        }

        .slider-controls {
            position: absolute;
            top: 50%;
            width: 100%;
            display: flex;
            justify-content: space-between;
            z-index: 100;
        }

        .slider-controls button {
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            width: 45px;
            height: 45px;
            font-size: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            transition: background-color 0.3s ease, transform 0.3s ease;
            cursor: pointer;
        }

        .slider-controls .prev {
            position: absolute;
            left: -47px;
        }

        .slider-controls .next {
            position: absolute;
            right: -47px;
        }

        .slider-controls button:hover {
            background-color: rgba(0, 0, 0, 0.8);
            transform: scale(1.2);
        }

        .slider-controls button:focus {
            outline: none;
        }

        .dots {
            text-align: center;
            margin-top: 10px;
        }

        .dot {
            height: 15px;
            width: 15px;
            margin: 0 2px;
            background-color: #bbb;
            border-radius: 50%;
            display: inline-block;
            transition: background-color 0.3s ease;
            cursor: pointer;
        }

        .dot.active {
            background-color: #717171;
        }
    </style>




    </div>